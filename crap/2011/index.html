<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>2011 Ball Drop</title>
<style>
	html {
		overflow:hidden;
	}
	#future {
		position:absolute;
		top:0px;
		left:0px;
		width:100%;
		height:100%;
	}
	#tower {
		z-index:2;
		position:relative;	
		top:0px;
		height:1000px;
		border-bottom:10px solid #000;
	}
	#ball {
		position:absolute;
		width:300px;
		height:250px;
		background:#333;
	}
	#time {
		font-family:Arial, Helvetica, sans-serif;
		color:#fff;
		position:absolute;
		top:0px;
		font-size:180px;
		text-align:center;
		text-shadow:0px 0px 40px #0F0;
	}
</style>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script>

	var now = (new Date()).getSeconds();
	var timeLeft = 60 - now;
	var secondHeight = 0;
	var balls = ["ffuu.png","meatball.png","rutabaga.png","cookie.png","pacman.png","smile.png"];
	var done = false;
	
	$(function() {
		$("#ball").hide();
	
		$("#tower").css({height:$(window).height()});
		$("#time").css({width:$(window).width()});
		secondHeight = $(window).height() / timeLeft;
		
		// drop ball
		$("#ball").css({left:$(window).width()/2-150});
		countdown = setInterval(function() {
			
			$("#ball").animate({bottom:(timeLeft*secondHeight)-10},function() { $("#ball").show(); });			
			timeLeft = timeLeft > 0 ? timeLeft-1:0;
			var showTime = (new Date()).getSeconds()
			if(timeLeft==0 && !done) {
				done = true;
				clearInterval(countdown);
				setInterval(zomg,100);
			}
			$("#time").html("<br>11:59:" + showTime);
		},1000);
		
		// switch balls
		setInterval(function() {
			var bg = balls[Math.round(Math.random()*(balls.length-1))];
			$("#ball").css({background:"url(balls/" + bg + ")"});
		},300);
	});
	
	function zomg() {
		//$("#ball").remove();
		if($("#sound object").length<5) {
			$("#sound").append('<object width="640" height="385"><param name="movie" value="http://www.youtube.com/v/awOL27A565U?fs=1&amp;hl=en_US&autoplay=1"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="http://www.youtube.com/v/awOL27A565U?fs=1&amp;hl=en_US&autoplay=1" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="640" height="385"></embed></object>');
		}
		setTimeout(function() {
			//$("#bttf").remove();
		},1000);
		$("#time").html("ZOMG 2011!");
		setInterval(function() {
			if($("#time").is(":hidden")) {
				$("#time").show();
			} else {
				$("#time").hide();
			}
		},900);
		$("#future").animate({
			width:"+=10",
			height:"+=10",
			left:"-=5",
			top:"-=5"
		})
	}
	
</script>
</head>
<body>
<div id="tower">
    <div id="time"></div>
	<div id="ball"></div>
</div>
<div id="sound"><br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />

<div id="bttf">
<object width="480" height="385"><param name="movie" value="http://www.youtube.com/v/XTGyeGgMpk8?fs=1&amp;hl=en_US&autoplay=1"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="http://www.youtube.com/v/XTGyeGgMpk8?fs=1&amp;hl=en_US&autoplay=1" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="480" height="385"></embed></object>
</div>
</div>
<img src="images/future.jpg" id="future" />
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-19109053-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</body>
</html>
